<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataSystem 수정</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .section {
            background: #f0f0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background: #3498db;
            color: white;
        }
        pre {
            background: #333;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>DataSystem 로컬 데이터 수정</h1>
    
    <div class="section">
        <h2>1. 현재 로컬 스토리지 데이터</h2>
        <button onclick="checkLocalData()">로컬 데이터 확인</button>
        <pre id="local-data"></pre>
    </div>
    
    <div class="section">
        <h2>2. 미팅 참가자 수 초기화</h2>
        <button onclick="resetMeetingParticipants()">참가자 수 초기화</button>
        <button onclick="updateConservativeFemale()">보수 여성 3명으로 설정</button>
    </div>
    
    <div class="section">
        <h2>3. DataSystem 완전 초기화</h2>
        <button onclick="clearAllDataSystem()">모든 DataSystem 데이터 삭제</button>
    </div>
    
    <div class="section">
        <h2>실행 결과</h2>
        <div id="result"></div>
    </div>
    
    <script>
        function log(message, type = 'info') {
            const resultDiv = document.getElementById('result');
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
            resultDiv.innerHTML += `<p class="${className}">${message}</p>`;
        }
        
        function checkLocalData() {
            const meetings = localStorage.getItem('sidepick_meetings');
            const bookings = localStorage.getItem('sidepick_bookings');
            
            const data = {
                meetings: meetings ? JSON.parse(meetings) : null,
                bookings: bookings ? JSON.parse(bookings) : null
            };
            
            document.getElementById('local-data').textContent = JSON.stringify(data, null, 2);
            
            if (data.meetings) {
                Object.entries(data.meetings).forEach(([key, meeting]) => {
                    log(`${key}: 남 ${meeting.currentParticipants.male}/4, 여 ${meeting.currentParticipants.female}/4`);
                });
            }
        }
        
        function resetMeetingParticipants() {
            const meetingsData = localStorage.getItem('sidepick_meetings');
            if (meetingsData) {
                const meetings = JSON.parse(meetingsData);
                
                // 모든 미팅의 참가자 수를 0으로 초기화
                Object.keys(meetings).forEach(key => {
                    meetings[key].currentParticipants = { male: 0, female: 0 };
                });
                
                localStorage.setItem('sidepick_meetings', JSON.stringify(meetings));
                log('모든 미팅 참가자 수를 초기화했습니다.', 'success');
                checkLocalData();
            } else {
                log('미팅 데이터가 없습니다.', 'error');
            }
        }
        
        function updateConservativeFemale() {
            const meetingsData = localStorage.getItem('sidepick_meetings');
            if (meetingsData) {
                const meetings = JSON.parse(meetingsData);
                
                if (meetings.conservative) {
                    meetings.conservative.currentParticipants.female = 3;
                    localStorage.setItem('sidepick_meetings', JSON.stringify(meetings));
                    log('보수 여성 참가자를 3명으로 설정했습니다.', 'success');
                } else {
                    log('보수 미팅 데이터가 없습니다.', 'error');
                }
                checkLocalData();
            }
        }
        
        function clearAllDataSystem() {
            if (confirm('정말로 모든 DataSystem 데이터를 삭제하시겠습니까?')) {
                localStorage.removeItem('sidepick_meetings');
                localStorage.removeItem('sidepick_bookings');
                localStorage.removeItem('sidepick_payments');
                log('모든 DataSystem 데이터를 삭제했습니다.', 'success');
                log('페이지를 새로고침하면 기본 데이터가 다시 생성됩니다.', 'success');
                checkLocalData();
            }
        }
        
        // 초기 로드
        checkLocalData();
    </script>
</body>
</html>