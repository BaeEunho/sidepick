<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì†Œê°œíŒ… ì¼ì • - ì‚¬ì´ë“œí”½</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="schedule-styles.css">
    <style>
        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ì˜¤ë²„ë¼ì´ë“œ - footer ìœ„ì— í‘œì‹œë˜ë„ë¡ */
        #paymentModal.payment-modal-overlay {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            z-index: 999999 !important;
            display: none;
            justify-content: center !important;
            align-items: center !important;
            background-color: rgba(0, 0, 0, 0.7) !important;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            overflow-y: auto !important;
            -webkit-overflow-scrolling: touch !important;
        }
        
        #paymentModal.payment-modal-overlay[style*="flex"] {
            display: flex !important;
        }
        
        #paymentModal .payment-modal-content {
            position: relative !important;
            z-index: 1000000 !important;
            background: white !important;
            border-radius: 20px !important;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;
            max-width: 480px !important;
            width: 90% !important;
            max-height: 90vh !important;
            padding: 0 !important;
            overflow: hidden !important;
            animation: modalSlideIn 0.3s ease-out !important;
            margin: 20px auto !important;
            overflow-y: auto !important;
            -webkit-overflow-scrolling: touch !important;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        #paymentModal .modal-close {
            position: absolute !important;
            top: 20px !important;
            right: 20px !important;
            width: 36px !important;
            height: 36px !important;
            border-radius: 50% !important;
            background: rgba(0, 0, 0, 0.05) !important;
            border: none !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-size: 24px !important;
            color: #666 !important;
            transition: all 0.2s ease !important;
            z-index: 10 !important;
        }
        
        #paymentModal .modal-close:hover {
            background: rgba(0, 0, 0, 0.1) !important;
            color: #333 !important;
            transform: rotate(90deg) !important;
        }
        
        #paymentModal .modal-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            font-size: 24px !important;
            font-weight: 700 !important;
            padding: 30px 30px 25px !important;
            margin: 0 !important;
            text-align: center !important;
        }
        
        #paymentModal .modal-section {
            padding: 30px !important;
            margin: 0 !important;
        }
        
        #paymentModal .modal-section h3 {
            display: none !important;
        }
        
        #paymentModal .payment-info-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%) !important;
            border-radius: 15px !important;
            padding: 25px !important;
            margin-bottom: 20px !important;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08) !important;
        }
        
        #paymentModal .info-row {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            padding: 15px 0 !important;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06) !important;
        }
        
        #paymentModal .info-row:last-child {
            border-bottom: none !important;
        }
        
        #paymentModal .info-label {
            color: #666 !important;
            font-size: 15px !important;
            font-weight: 500 !important;
        }
        
        #paymentModal .info-value {
            color: #2c3e50 !important;
            font-size: 16px !important;
            font-weight: 700 !important;
        }
        
        #paymentModal .info-value.highlight {
            color: #5f3dc4 !important;
            font-size: 17px !important;
            background: rgba(103, 126, 234, 0.1) !important;
            padding: 8px 15px !important;
            border-radius: 8px !important;
        }
        
        #paymentModal .payment-notice {
            background: #fff3cd !important;
            border: 1px solid #ffeaa7 !important;
            border-radius: 10px !important;
            padding: 12px 18px !important;
            margin: 12px 0 !important;
            color: #856404 !important;
            font-size: 14px !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
        }
        
        #paymentModal .payment-notice:before {
            content: "âš ï¸" !important;
            font-size: 18px !important;
        }
        
        #paymentModal .modal-actions {
            background: #f8f9fa !important;
            padding: 20px 30px !important;
            display: flex !important;
            gap: 12px !important;
            margin: 0 !important;
            border-top: 1px solid #e9ecef !important;
        }
        
        #paymentModal .btn-secondary,
        #paymentModal .btn-primary {
            flex: 1 !important;
            padding: 14px 24px !important;
            border: none !important;
            border-radius: 10px !important;
            font-size: 16px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.2s ease !important;
            position: relative !important;
            overflow: hidden !important;
        }
        
        #paymentModal .btn-secondary {
            background: white !important;
            color: #495057 !important;
            border: 2px solid #dee2e6 !important;
        }
        
        #paymentModal .btn-secondary:hover {
            background: #f8f9fa !important;
            border-color: #adb5bd !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1) !important;
        }
        
        #paymentModal .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3) !important;
        }
        
        #paymentModal .btn-primary:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 7px 20px rgba(102, 126, 234, 0.4) !important;
        }
        
        #paymentModal .btn-primary:active,
        #paymentModal .btn-secondary:active {
            transform: translateY(0) !important;
        }
    </style>
    <script src="gtm-loader.js"></script>
    <script src="auth-system.js"></script>
    <!-- data-system.js ì œê±° - Firebase ì§ì ‘ ì‚¬ìš© -->
    <script src="auth-check.js"></script>
    <script src="api-client.js"></script>
</head>
<body>
    <!-- í—¤ë” -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo">
                <a href="index.html">ì‚¬ì´ë“œí”½</a>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html#intro">ì„œë¹„ìŠ¤ ì†Œê°œ</a></li>
                <li><a href="index.html#test">ì„±í–¥ í…ŒìŠ¤íŠ¸</a></li>
                <li><a href="index.html#meeting">ì˜¤í”„ë¼ì¸ ì†Œê°œíŒ…</a></li>
                <li><a href="index.html#faq">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</a></li>
            </ul>
            <div class="nav-cta">
                <a href="political-test.html?logged_in=true" class="nav-btn">ì„±í–¥ í…ŒìŠ¤íŠ¸ ë°›ê¸°</a>
            </div>
        </nav>
    </header>

    <!-- ëª¨ì„ ì¼ì • ì„¹ì…˜ -->
    <section class="schedule-section">
        <div class="container">
            <div class="user-type-info">
                <h1>ë‹¹ì‹ ì˜ ì •ì¹˜ ì„±í–¥</h1>
                <div class="type-display">
                    <span id="user-type-icon">ğŸŒ</span>
                    <h2 id="user-type-title">ì‹œì¥ ë‹¤ì›ì£¼ì˜ì</h2>
                </div>
                <p id="orientation-text" class="orientation-info">ì§„ë³´ ì„±í–¥ ì†Œê°œíŒ…ì— ì°¸ì—¬í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
            </div>

            <div class="schedule-content">
                <h2>8ì›” ì†Œê°œíŒ… ì¼ì •</h2>
                <div id="progressive-meetings" class="meetings-section">
                    <h3 class="orientation-label progressive">ì§„ë³´ ì„±í–¥ ì†Œê°œíŒ…</h3>
                    <div class="meetings-grid">
                        <div class="meeting-card">
                            <div class="meeting-date">
                                <span class="day">23</span>
                                <span class="month">8ì›”</span>
                                <span class="weekday">í† ìš”ì¼</span>
                            </div>
                            <div class="meeting-info">
                                <h4>ê°•ë‚¨ ì§„ë³´ ì„±í–¥ ì†Œê°œíŒ…</h4>
                                <p class="location">ğŸ“ ê°•ë‚¨ì—­ íŒŒí‹°ë£¸</p>
                                <p class="time">â° ì˜¤í›„ 3ì‹œ - 5ì‹œ</p>
                                <p class="participants">
                                    <span class="male-count" data-gender="male" data-current="0">ğŸ‘¨ ë‚¨ì 0/4ëª…</span>
                                    <span class="female-count" data-gender="female" data-current="0">ğŸ‘© ì—¬ì 0/4ëª…</span>
                                </p>
                                <div class="type-tags">
                                    <span class="type-tag">ì‹œì¥ ë‹¤ì›ì£¼ì˜ì</span>
                                    <span class="type-tag">í…Œí¬ë…¸ ììœ ì£¼ì˜ì</span>
                                    <span class="type-tag">ì°¸ì—¬ ììœ ì£¼ì˜ì</span>
                                    <span class="type-tag">ì—˜ë¦¬íŠ¸ ììœ ì£¼ì˜ì</span>
                                    <span class="type-tag">ì°¸ì—¬ ì‚¬íšŒë¯¼ì£¼ì£¼ì˜ì</span>
                                    <span class="type-tag">ì „ë¬¸ê°€ ì‚¬íšŒë¯¼ì£¼ì£¼ì˜ì</span>
                                    <span class="type-tag">ë¯¼ì¤‘ ì§„ë³´ì£¼ì˜ì</span>
                                    <span class="type-tag">ê³„íš ì§„ë³´ì£¼ì˜ì</span>
                                </div>
                            </div>
                            <div class="meeting-actions">
                                <button class="apply-btn" onclick="applyMeeting(this)">ì‹ ì²­í•˜ê¸°</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="conservative-meetings" class="meetings-section">
                    <h3 class="orientation-label conservative">ë³´ìˆ˜ ì„±í–¥ ì†Œê°œíŒ…</h3>
                    <div class="meetings-grid">
                        <div class="meeting-card">
                            <div class="meeting-date">
                                <span class="day">30</span>
                                <span class="month">8ì›”</span>
                                <span class="weekday">í† ìš”ì¼</span>
                            </div>
                            <div class="meeting-info">
                                <h4>ê°•ë‚¨ ë³´ìˆ˜ ì„±í–¥ ì†Œê°œíŒ…</h4>
                                <p class="location">ğŸ“ ê°•ë‚¨ì—­ íŒŒí‹°ë£¸</p>
                                <p class="time">â° ì˜¤í›„ 3ì‹œ - 5ì‹œ</p>
                                <p class="participants">
                                    <span class="male-count" data-gender="male" data-current="0">ğŸ‘¨ ë‚¨ì 0/4ëª…</span>
                                    <span class="female-count" data-gender="female" data-current="0">ğŸ‘© ì—¬ì 0/4ëª…</span>
                                </p>
                                <div class="type-tags">
                                    <span class="type-tag">ë¬¸í™” ë³´ìˆ˜ì£¼ì˜ì</span>
                                    <span class="type-tag">ì˜¨ê±´ ë³´ìˆ˜ì£¼ì˜ì</span>
                                    <span class="type-tag">í’€ë¿Œë¦¬ ë³´ìˆ˜ì£¼ì˜ì</span>
                                    <span class="type-tag">ì „í†µ ë³´ìˆ˜ì£¼ì˜ì</span>
                                    <span class="type-tag">ì˜¨ê±´ êµ­ê°€ì£¼ì˜ì</span>
                                    <span class="type-tag">ê¶Œìœ„ ë³´ìˆ˜ì£¼ì˜ì</span>
                                    <span class="type-tag">ë¯¼ì¡± ë³´ìˆ˜ì£¼ì˜ì</span>
                                    <span class="type-tag">ìœ„ê³„ ë³´ìˆ˜ì£¼ì˜ì</span>
                                </div>
                            </div>
                            <div class="meeting-actions">
                                <button class="apply-btn" onclick="applyMeeting(this)">ì‹ ì²­í•˜ê¸°</button>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>

            <div class="notice-box">
                <h3>ğŸ“Œ ì†Œê°œíŒ… ì•ˆë‚´ì‚¬í•­</h3>
                <ul>
                    <li>ëª¨ë“  ì†Œê°œíŒ…ì€ 8ëª…(ë‚¨ì„± 4ëª…, ì—¬ì„± 4ëª…)ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤</li>
                    <li>ì°¸ê°€ë¹„ëŠ” 1ì¸ë‹¹ 45,000ì›ì…ë‹ˆë‹¤</li>
                    <li>ë³¸ì¸ ì„±ë³„ì— í•´ë‹¹í•˜ëŠ” ìë¦¬ë§Œ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤</li>
                    <li>ì„±ë³„ ìë¦¬ê°€ ë§ˆê°ëœ ê²½ìš° ì•Œë¦¼ ì‹ ì²­ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤</li>
                    <li>ì‹ ì²­ í›„ 24ì‹œê°„ ì´ë‚´ì— í™•ì • ì•ˆë‚´ë¥¼ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                    <li>ì†Œê°œíŒ… 3ì¼ ì „ê¹Œì§€ ì·¨ì†Œ ê°€ëŠ¥í•˜ë©°, ì´í›„ ì·¨ì†Œ ì‹œ í™˜ë¶ˆì´ ì œí•œë©ë‹ˆë‹¤</li>
                    <li>ê°™ì€ ì •ì¹˜ ì„±í–¥ì„ ê°€ì§„ ë¶„ë“¤ë¼ë¦¬ë§Œ ëª¨ì´ë¯€ë¡œ í¸ì•ˆí•œ ëŒ€í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- í‘¸í„° -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ì‚¬ì´ë“œí”½</h3>
                    <p>ì •ì¹˜ ì„±í–¥ ê¸°ë°˜ ì˜¤í”„ë¼ì¸ ë§Œë‚¨ ì„œë¹„ìŠ¤</p>
                </div>
                <div class="footer-section">
                    <h4>ì„œë¹„ìŠ¤</h4>
                    <ul>
                        <li><a href="javascript:void(0)" onclick="checkAndGoToTest()">ì„±í–¥ í…ŒìŠ¤íŠ¸</a></li>
                        <li><a href="meeting-schedule.html">ëª¨ì„ ì¼ì •</a></li>
                        <li><a href="index.html#faq">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>ê³ ê°ì„¼í„°</h4>
                    <ul>
                        <li>í‰ì¼ 10:00 - 18:00</li>
                        <li><a href="mailto:clsrna3@naver.com">clsrna3@naver.com</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>ì •ì±…</h4>
                    <ul>
                        <li><a href="terms.html">ì´ìš©ì•½ê´€</a></li>
                        <li><a href="privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
                        <li><a href="refund.html">í™˜ë¶ˆì •ì±…</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ì‚¬ì´ë“œí”½. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- ê²°ì œ ì •ë³´ ëª¨ë‹¬ -->
    <div id="paymentModal" class="payment-modal-overlay" style="display: none;">
        <div class="payment-modal-content">
            <span class="modal-close" onclick="closePaymentModal()">&times;</span>
            <h2 class="modal-title">ê²°ì œ ì •ë³´</h2>
            
            <div class="modal-section">
                <h3>ê²°ì œ ì •ë³´</h3>
                <div class="payment-info-box">
                    <div class="info-row">
                        <span class="info-label">ì°¸ê°€ë¹„:</span>
                        <span class="info-value">45,000ì›</span>
                    </div>
                    <div class="info-row">
                        <span class="info-value highlight">ì‹ í•œì€í–‰ 110-386-140132 (ë°°ì€í˜¸)</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì…ê¸ˆìëª…:</span>
                        <span id="modal-depositor-name" class="info-value"></span>
                    </div>
                </div>
                <p class="payment-notice">* ì…ê¸ˆ í™•ì¸ í›„ ì°¸ê°€ê°€ í™•ì •ë©ë‹ˆë‹¤.</p>
                <p class="payment-notice">* ì…ê¸ˆ ê¸°í•œ: ì‹ ì²­ì¼ë¡œë¶€í„° 24ì‹œê°„ ì´ë‚´</p>
            </div>
            
            <div class="modal-actions">
                <button class="btn-secondary" onclick="copyAccountNumber()">ê³„ì¢Œë²ˆí˜¸ ë³µì‚¬</button>
                <button class="btn-primary" onclick="closePaymentModal()">í™•ì¸</button>
            </div>
        </div>
    </div>

    <script src="schedule-script.js?v=7"></script>
    <script src="attendance-update.js"></script>
    
    <!-- ì°¸ì„ ì¸ì› ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ -->
    <script>
        (function() {
            console.log('ì°¸ì„ ì¸ì› ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘');
            
            function updateAttendance() {
                console.log('ì°¸ì„ ì¸ì› ì—…ë°ì´íŠ¸ ì¤‘...');
                
                fetch('https://sidepick.onrender.com/api/meetings/attendance')
                    .then(response => response.json())
                    .then(data => {
                        console.log('API ì‘ë‹µ:', data);
                        
                        if (data.success && data.data) {
                            // ì§„ë³´ ëª¨ì„
                            let progressiveMale = 0;
                            let progressiveFemale = 0;
                            
                            // ë³´ìˆ˜ ëª¨ì„
                            let conservativeMale = 0;
                            let conservativeFemale = 0;
                            
                            // ë°ì´í„° ì§‘ê³„
                            Object.values(data.data).forEach(meeting => {
                                if (meeting.orientation === 'progressive') {
                                    progressiveMale += meeting.male;
                                    progressiveFemale += meeting.female;
                                } else if (meeting.orientation === 'conservative') {
                                    conservativeMale += meeting.male;
                                    conservativeFemale += meeting.female;
                                }
                            });
                            
                            // ëª¨ë“  male-countì™€ female-count ìš”ì†Œ ì°¾ê¸°
                            document.querySelectorAll('.meeting-card').forEach(card => {
                                const isProgressive = card.closest('#progressive-meetings');
                                const isConservative = card.closest('#conservative-meetings');
                                
                                const maleCount = card.querySelector('.male-count');
                                const femaleCount = card.querySelector('.female-count');
                                
                                if (isProgressive) {
                                    if (maleCount) maleCount.textContent = `ğŸ‘¨ ë‚¨ì ${progressiveMale}/4ëª…`;
                                    if (femaleCount) femaleCount.textContent = `ğŸ‘© ì—¬ì ${progressiveFemale}/4ëª…`;
                                } else if (isConservative) {
                                    if (maleCount) maleCount.textContent = `ğŸ‘¨ ë‚¨ì ${conservativeMale}/4ëª…`;
                                    if (femaleCount) femaleCount.textContent = `ğŸ‘© ì—¬ì ${conservativeFemale}/4ëª…`;
                                }
                            });
                            
                            console.log('ì—…ë°ì´íŠ¸ ì™„ë£Œ - ì§„ë³´:', progressiveMale, 'ë‚¨/', progressiveFemale, 'ì—¬, ë³´ìˆ˜:', conservativeMale, 'ë‚¨/', conservativeFemale, 'ì—¬');
                        }
                    })
                    .catch(error => {
                        console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                    });
            }
            
            updateAttendance()
        })();
    </script>
</body>
</html>